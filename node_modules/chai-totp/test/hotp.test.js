/**
 * @Description:
 * @author Lavi Chai
 * @date 2020/2/20 10:36
 */

const assert = require('assert');
const HOTP = require('../lib/hotp');

describe('HOTP', () => {
  const key = HOTP.base32.encode('12345678901234567890');

  it('shoule equal with the test values', () => {
    const hotp = new HOTP(key);
    assert('755224' === hotp.genOTP(0));
    assert('287082' === hotp.genOTP(1));
    assert('359152' === hotp.genOTP(2));
    assert('969429' === hotp.genOTP(3));
    assert('338314' === hotp.genOTP(4));
    assert('254676' === hotp.genOTP(5));
    assert('287922' === hotp.genOTP(6));
    assert('162583' === hotp.genOTP(7));
    assert('399871' === hotp.genOTP(8));
    assert('520489' === hotp.genOTP(9));
  });

  it.skip('google authenticator url', () => {
    assert(new HOTP(key).gaURL('a', 'b') === `otpauth://hotp/a?issuer=b&secret=${key}`)
  });
});
